{"1727208012813":{"actionType":"saveAll","createdAt":"1727208012813","actionID":"1727208012813","userID":"#TEMP","path":"system.capsules.5bbf809b-5c91-4d02-9677-ffec28704efe.capsUseCodeInfo.capsUseInputs.sss_freeValue-0.capsIptTxtValue","oldValue":"// import * as firebase from 'https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js';\n// import * as firestore from 'https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js';\nimport { initializeApp } from 'firebase/app';\n// import firebase from 'firebase/app';\nimport * as firestore from 'firebase/firestore';\n// import firestore from 'firebase/firestore';\n// import { getFirestore, collection, getDocs } from 'firebase/firestore';\n\n// type Tprops = {\n//   args: any;\n//   pass: {\n//     fbInit: any;\n//     arrRefStrings: string[];\n//     arrWhere: any;\n//     arrFuncs: any[];\n//   };\n// };\n\n// Build failed with 1 error:\n// teste-firebase:https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js:1:126: ERROR: [plugin: Flax Web Plugin] Failed to construct 'URL': Invalid base URL\n\n// export const css1 =\n//   'color: green; background-color: black; font-size: 11px; padding: 2px 6px; border-radius: 3px';\n// export const css2 =\n//   'color: yellow; background-color: green; font-size: 10px; padding: 2px 6px; border-radius: 3px';\n\n// export const where = async (props: Tprops) => {\nexport const where = async () => {\n  // console.log('where', firebase, firestore);\n  // console.log('where', initializeApp);\n  console.log('where', firestore);\n  //   const { initializeApp } = firebase;\n  const { getFirestore, collection, getDocs } = firestore;\n\n  //   console.log('Script 2');\n  //   console.log(initializeApp);\n  //   // Configurações do Firebase\n  const firebaseConfig = {\n    apiKey: 'AIzaSyDjAfyEUADq7EaRyFWlGFjP1Eoox9LJHgI',\n    authDomain: 'devs-tests-95208.firebaseapp.com',\n    projectId: 'devs-tests-95208',\n    storageBucket: 'devs-tests-95208.appspot.com',\n    messagingSenderId: '750912250366',\n    appId: '1:750912250366:web:4629eac789a718a74220af',\n  };\n\n  //   // Inicializar o Firebase\n  const initFb = initializeApp(firebaseConfig);\n  console.log({ initFb });\n\n  //   // Inicializar o Firestore\n  const db = getFirestore(initFb);\n  console.log({ db });\n\n  const refColl = collection(db, 'users');\n  console.log({ refColl });\n\n  // Obtendo documentos da coleção\n  const querySnapshot = await getDocs(refColl);\n  querySnapshot.forEach(doc => {\n    console.log(doc.data());\n  });\n};\n","newValue":"// import * as firebase from 'https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js';\n// import * as firestore from 'https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js';\n// import { initializeApp } from 'firebase/app';\n// import firebase from 'firebase/app';\nimport * as firestore from 'firebase/firestore';\n// import firestore from 'firebase/firestore';\n// import { getFirestore, collection, getDocs } from 'firebase/firestore';\n\ntype Tprops = {\n  args: any;\n  pass: {\n    fbInit: any;\n    arrRefStrings: string[];\n    arrWhere: any;\n    arrFuncs: any[];\n  };\n};\n\n// Build failed with 1 error:\n// teste-firebase:https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js:1:126: ERROR: [plugin: Flax Web Plugin] Failed to construct 'URL': Invalid base URL\n\nexport const css1 =\n  'color: green; background-color: black; font-size: 11px; padding: 2px 6px; border-radius: 3px';\nexport const css2 =\n  'color: yellow; background-color: green; font-size: 10px; padding: 2px 6px; border-radius: 3px';\n\nexport const where = async (props: Tprops) => {\n  // ---------- set Props\n  const { args, pass } = props;\n  const { fbInit, arrRefStrings, arrWhere, arrFuncs } = pass;\n\n  // ---------- set Local Imports\n  const { getFirestore, getDocs, collection, where, query } = firestore;\n  // ---------- set Caps Inputs\n\n  // ---------- set Short Str\n  const fbErrMsg1 = 'Alguma entrada where foi preenchida errado.';\n  const par1 = 'noComponent';\n\n  // -----------------------------\n  // ---------- set Init Firestore\n  // -----------------------------\n  if (!fbInit) return console.log(fbErrMsg1, { fbInit });\n  const fireInit: any = getFirestore(fbInit[0]);\n\n  const arrConds = [];\n  const newArrWh = () => {\n    const promiseArray = arrWhere.map((capsCond: any) => {\n      const resolve = capsCond();\n\n      arrConds.push(resolve);\n\n      return getDocs(\n        query(refColl, where(resolve.field, resolve.operator, resolve.value)),\n      );\n    });\n\n    return promiseArray;\n  };\n\n  const refColl = collection(fireInit, ...arrRefStrings);\n  const resolvePromise = await Promise.all(newArrWh());\n\n  const arrDocs = [];\n  resolvePromise &&\n    resolvePromise.forEach((snaps: any) => {\n      snaps.forEach((doc: any) => {\n        arrDocs.push(doc.data());\n      });\n    });\n\n  console.log('%cWhere Cond', css1, { arrConds });\n  console.log('%cWhere Docs Found', css2, { arrDocs });\n\n  for (const currFunc of arrFuncs) currFunc(arrDocs, args);\n};\n"}}